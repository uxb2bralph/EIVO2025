@using System.IO
@using System.Linq.Expressions


@using ModelCore.DataEntity
@using ModelCore.Locale
@using CommonLib.Core.Utility
@using CommonLib.Utility
@using Microsoft.AspNetCore.Mvc.ModelBinding
@using Microsoft.AspNetCore.Mvc.Razor
@{

    IQueryable<UnassignedInvoiceNo> _model = (IQueryable<UnassignedInvoiceNo>)this.Model;
}
@{
    await Html.RenderPartialAsync("~/Views/SiteAction/FunctionTitleBar.cshtml", "查詢結果");
}


<div class="border_gray query_result">
    @{
        var recordCount = _model.Count();
    }
    @if (recordCount > 0)
    {
        await Html.RenderPartialAsync("~/Views/InvoiceNo/VacantNo/ItemList.cshtml", _model);

        <div id="tblAction" class="my-3">
            <button type="button" id="btnDownloadXml" name="btnDownloadXml"
                class="px-3 my-1 me-1 btn btn-sm eivo__btn--default" onclick="uiVacantNoQuery.download();">
                <i class="fas fa-download"></i>
                Xml 下載
            </button>
            <button type="button" id="btnDownloadCsv" name="btnDownloadCsv"
                class="px-3 my-1 me-1 btn btn-sm eivo__btn--default" onclick="uiVacantNoQuery.downloadCsv();">
                <i class="fas fa-download"></i>
                Csv 下載
            </button>
        </div>
    }
    else
    {
        <font color="red">查無資料!!</font>
    }
</div>
